!define TEST_SYSTEM {slim}
!define user {hgva}
!define baseURL {http://bioinfodev.hpc.cam.ac.uk/${user}/webservices/rest/}
!path dependencies/*.jar


!|import|
|smartrics.rest.fitnesse.fixture|

!|Table: Rest Fixture Config|
|restfixture.display.toggle.for.cells.larger.than|200|
|http.client.connection.timeout| 100000|

!3 Login User Test
!|Table: Rest Fixture | ${baseURL} |
| setBody | {"password" : "hgva"}|
| setHeaders|Content-Type: application/json|
| POST | /v1/users/hgva/login |  |  Content-Type: application/json |jsonbody.response[0].result[0].userId === 'hgva'|
|let|sessionId|js|response.jsonbody.response[0].result[0].sessionId||

!3 Create User Test 
!|Table: smartrics.rest.fitnesse.fixture.RestFixture  | http://bioinfodev.hpc.cam.ac.uk/hgva/webservices/rest/ |
| setBody |  { "name": "test", "userId": "test","email": "test@test.com" }|
| setHeaders|Content-Type: application/json|
| POST | /v1/users/create?sid=$sessionId | 500 | Content-Type : application/json| jsonbody.error === 'The registration is closed to the public: Please talk to your administrator.' |



!3 Create User Test 
!|Table: smartrics.rest.fitnesse.fixture.RestFixture  | http://bioinfodev.hpc.cam.ac.uk/hgva/webservices/rest/ |
| setBody |  { "name": "test", "userId": "test","email": "test@test.com" }|
| setHeaders|Content-Type: application/json|
| POST | /v1/users/create?sid=$sessionId | 500 | Content-Type : application/json| jsonbody.error === 'The registration is closed to the public: Please talk to your administrator.' |
