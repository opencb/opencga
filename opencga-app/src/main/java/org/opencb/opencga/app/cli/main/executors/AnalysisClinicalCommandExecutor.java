package org.opencb.opencga.app.cli.main.executors;

import org.opencb.opencga.app.cli.main.executors.OpencgaCommandExecutor;
import org.opencb.opencga.app.cli.main.*;
import org.opencb.opencga.core.response.RestResponse;
import org.opencb.opencga.client.exceptions.ClientException;
import org.opencb.commons.datastore.core.ObjectMap;

import org.opencb.opencga.catalog.exceptions.CatalogAuthenticationException;
import org.opencb.opencga.core.common.JacksonUtils;

import com.fasterxml.jackson.databind.ObjectMapper;
import java.util.List;
import java.util.HashMap;
import org.opencb.opencga.core.response.QueryType;
import org.opencb.commons.utils.PrintUtils;

import org.opencb.opencga.app.cli.main.options.AnalysisClinicalCommandOptions;

import java.util.Map;
import org.opencb.biodata.models.clinical.ClinicalProperty;
import org.opencb.biodata.models.clinical.interpretation.ClinicalVariant;
import org.opencb.biodata.models.clinical.interpretation.InterpretationMethod;
import org.opencb.commons.datastore.core.FacetField;
import org.opencb.commons.datastore.core.ObjectMap;
import org.opencb.opencga.catalog.utils.ParamUtils.AclAction;
import org.opencb.opencga.catalog.utils.ParamUtils.AddRemoveReplaceAction;
import org.opencb.opencga.catalog.utils.ParamUtils.BasicUpdateAction;
import org.opencb.opencga.catalog.utils.ParamUtils.SaveInterpretationAs;
import org.opencb.opencga.catalog.utils.ParamUtils.UpdateAction;
import org.opencb.opencga.core.models.analysis.knockout.KnockoutByGeneSummary;
import org.opencb.opencga.core.models.analysis.knockout.KnockoutByIndividual;
import org.opencb.opencga.core.models.analysis.knockout.KnockoutByIndividualSummary;
import org.opencb.opencga.core.models.analysis.knockout.KnockoutByVariant;
import org.opencb.opencga.core.models.analysis.knockout.KnockoutByVariantSummary;
import org.opencb.opencga.core.models.analysis.knockout.RgaKnockoutByGene;
import org.opencb.opencga.core.models.clinical.CancerTieringInterpretationAnalysisParams;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysis;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysisAclUpdateParams;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysisCreateParams;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysisQualityControl;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysisQualityControlUpdateParam;
import org.opencb.opencga.core.models.clinical.ClinicalAnalysisUpdateParams;
import org.opencb.opencga.core.models.clinical.ClinicalAnalystParam;
import org.opencb.opencga.core.models.clinical.ClinicalReport;
import org.opencb.opencga.core.models.clinical.DisorderReferenceParam;
import org.opencb.opencga.core.models.clinical.FamilyParam;
import org.opencb.opencga.core.models.clinical.Interpretation;
import org.opencb.opencga.core.models.clinical.InterpretationCreateParams;
import org.opencb.opencga.core.models.clinical.InterpretationUpdateParams;
import org.opencb.opencga.core.models.clinical.PriorityParam;
import org.opencb.opencga.core.models.clinical.ProbandParam;
import org.opencb.opencga.core.models.clinical.RgaAnalysisParams;
import org.opencb.opencga.core.models.clinical.TeamInterpretationAnalysisParams;
import org.opencb.opencga.core.models.clinical.TieringInterpretationAnalysisParams;
import org.opencb.opencga.core.models.clinical.ZettaInterpretationAnalysisParams;
import org.opencb.opencga.core.models.common.StatusParam;
import org.opencb.opencga.core.models.job.Job;
import org.opencb.opencga.core.models.study.configuration.ClinicalAnalysisStudyConfiguration;
import org.opencb.opencga.core.models.study.configuration.ClinicalConsentAnnotationParam;
import org.opencb.opencga.core.models.study.configuration.ClinicalConsentConfiguration;
import org.opencb.opencga.core.models.study.configuration.InterpretationStudyConfiguration;


/*
* WARNING: AUTOGENERATED CODE
*
* This code was generated by a tool.
* Autogenerated on: 2022-06-30
*
* Manual changes to this file may cause unexpected behavior in your application.
* Manual changes to this file will be overwritten if the code is regenerated.
*/


/**
 * This class contains methods for the Analysis - Clinical command line.
 *    OpenCGA version: 2.4.0-SNAPSHOT
 *    PATH: /{apiVersion}/analysis/clinical
 */
public class AnalysisClinicalCommandExecutor extends OpencgaCommandExecutor {

    private AnalysisClinicalCommandOptions analysisClinicalCommandOptions;

    public AnalysisClinicalCommandExecutor(AnalysisClinicalCommandOptions analysisClinicalCommandOptions) throws CatalogAuthenticationException {
        super(analysisClinicalCommandOptions.commonCommandOptions);
        this.analysisClinicalCommandOptions = analysisClinicalCommandOptions;
    }

    @Override
    public void execute() throws Exception {

        logger.debug("Executing Analysis - Clinical command line");

        String subCommandString = getParsedSubCommand(analysisClinicalCommandOptions.jCommander);

        RestResponse queryResponse = null;

        switch (subCommandString) {
            case "acl-update":
                queryResponse = updateAcl();
                break;
            case "clinical-configuration-update":
                queryResponse = updateClinicalConfiguration();
                break;
            case "create":
                queryResponse = create();
                break;
            case "distinct":
                queryResponse = distinct();
                break;
            case "interpretation-distinct":
                queryResponse = distinctInterpretation();
                break;
            case "interpretation-search":
                queryResponse = searchInterpretation();
                break;
            case "interpretation-info":
                queryResponse = infoInterpretation();
                break;
            case "interpreter-cancer-tiering-run":
                queryResponse = runInterpreterCancerTiering();
                break;
            case "interpreter-team-run":
                queryResponse = runInterpreterTeam();
                break;
            case "interpreter-tiering-run":
                queryResponse = runInterpreterTiering();
                break;
            case "interpreter-zetta-run":
                queryResponse = runInterpreterZetta();
                break;
            case "rga-aggregation-stats":
                queryResponse = aggregationStatsRga();
                break;
            case "rga-gene-query":
                queryResponse = queryRgaGene();
                break;
            case "rga-gene-summary":
                queryResponse = summaryRgaGene();
                break;
            case "rga-index-run":
                queryResponse = runRgaIndex();
                break;
            case "rga-individual-query":
                queryResponse = queryRgaIndividual();
                break;
            case "rga-individual-summary":
                queryResponse = summaryRgaIndividual();
                break;
            case "rga-variant-query":
                queryResponse = queryRgaVariant();
                break;
            case "rga-variant-summary":
                queryResponse = summaryRgaVariant();
                break;
            case "search":
                queryResponse = search();
                break;
            case "variant-actionable":
                queryResponse = actionableVariant();
                break;
            case "variant-query":
                queryResponse = queryVariant();
                break;
            case "acl":
                queryResponse = acl();
                break;
            case "delete":
                queryResponse = delete();
                break;
            case "update":
                queryResponse = update();
                break;
            case "info":
                queryResponse = info();
                break;
            case "interpretation-create":
                queryResponse = createInterpretation();
                break;
            case "interpretation-clear":
                queryResponse = clearInterpretation();
                break;
            case "interpretation-delete":
                queryResponse = deleteInterpretation();
                break;
            case "interpretation-revert":
                queryResponse = revertInterpretation();
                break;
            case "interpretation-update":
                queryResponse = updateInterpretation();
                break;
            default:
                logger.error("Subcommand not valid");
                break;
        }

        createOutput(queryResponse);

    }

    private RestResponse<ObjectMap> updateAcl() throws Exception {

        logger.debug("Executing updateAcl in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.UpdateAclCommandOptions commandOptions = analysisClinicalCommandOptions.updateAclCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("propagate", commandOptions.propagate);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        ClinicalAnalysisAclUpdateParams clinicalAnalysisAclUpdateParams = new ClinicalAnalysisAclUpdateParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<ObjectMap> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(clinicalAnalysisAclUpdateParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            clinicalAnalysisAclUpdateParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), ClinicalAnalysisAclUpdateParams.class);
        } else {
            clinicalAnalysisAclUpdateParams.setPermissions(commandOptions.permissions);
            clinicalAnalysisAclUpdateParams.setClinicalAnalysis(commandOptions.clinicalAnalysis);

        }
        return openCGAClient.getClinicalAnalysisClient().updateAcl(commandOptions.members, commandOptions.action, clinicalAnalysisAclUpdateParams, queryParams);
    }

    private RestResponse<ObjectMap> updateClinicalConfiguration() throws Exception {

        logger.debug("Executing updateClinicalConfiguration in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.UpdateClinicalConfigurationCommandOptions commandOptions = analysisClinicalCommandOptions.updateClinicalConfigurationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        ClinicalAnalysisStudyConfiguration clinicalAnalysisStudyConfiguration = new ClinicalAnalysisStudyConfiguration();
        if (commandOptions.jsonDataModel) {
            RestResponse<ObjectMap> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(clinicalAnalysisStudyConfiguration));
            return res;
        } else if (commandOptions.jsonFile != null) {
            clinicalAnalysisStudyConfiguration = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), ClinicalAnalysisStudyConfiguration.class);
        }
        return openCGAClient.getClinicalAnalysisClient().updateClinicalConfiguration(clinicalAnalysisStudyConfiguration, queryParams);
    }

    private RestResponse<ClinicalAnalysis> create() throws Exception {

        logger.debug("Executing create in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.CreateCommandOptions commandOptions = analysisClinicalCommandOptions.createCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("skipCreateDefaultInterpretation", commandOptions.skipCreateDefaultInterpretation);
        queryParams.putIfNotNull("includeResult", commandOptions.includeResult);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        ClinicalAnalysisCreateParams clinicalAnalysisCreateParams = new ClinicalAnalysisCreateParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<ClinicalAnalysis> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(clinicalAnalysisCreateParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            clinicalAnalysisCreateParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), ClinicalAnalysisCreateParams.class);
        } else {
            // Generate beans for nested objects
            DisorderReferenceParam disorderParam = new DisorderReferenceParam();
            disorderParam.setId(commandOptions.disorderId);

            ProbandParam probandParam = new ProbandParam();
            probandParam.setId(commandOptions.probandId);
            //probandParam.setSamples(commandOptions.probandSamples);  // Unsupported param. FIXME

            FamilyParam familyParam = new FamilyParam();
            familyParam.setId(commandOptions.familyId);
            //familyParam.setMembers(commandOptions.familyMembers);  // Unsupported param. FIXME

            ClinicalAnalystParam analystParam = new ClinicalAnalystParam();
            analystParam.setId(commandOptions.analystId);

            ClinicalReport reportParam = new ClinicalReport();
            reportParam.setTitle(commandOptions.reportTitle);
            reportParam.setOverview(commandOptions.reportOverview);
            reportParam.setDiscussion(commandOptions.reportDiscussion);
            reportParam.setLogo(commandOptions.reportLogo);
            reportParam.setSignedBy(commandOptions.reportSignedBy);
            reportParam.setSignature(commandOptions.reportSignature);
            reportParam.setDate(commandOptions.reportDate);

            InterpretationCreateParams interpretationParam = new InterpretationCreateParams();
            interpretationParam.setDescription(commandOptions.interpretationDescription);
            interpretationParam.setClinicalAnalysisId(commandOptions.interpretationClinicalAnalysisId);
            interpretationParam.setCreationDate(commandOptions.interpretationCreationDate);
            interpretationParam.setModificationDate(commandOptions.interpretationModificationDate);
            //interpretationParam.setAnalyst(commandOptions.interpretationAnalyst);  // Unsupported param. FIXME
            //interpretationParam.setMethod(commandOptions.interpretationMethod);  // Unsupported param. FIXME
            //interpretationParam.setPrimaryFindings(commandOptions.interpretationPrimaryFindings);  // Unsupported param. FIXME
            //interpretationParam.setSecondaryFindings(commandOptions.interpretationSecondaryFindings);  // Unsupported param. FIXME
            //interpretationParam.setPanels(commandOptions.interpretationPanels);  // Unsupported param. FIXME
            //interpretationParam.setComments(commandOptions.interpretationComments);  // Unsupported param. FIXME
            interpretationParam.setLocked(commandOptions.interpretationLocked);
            //interpretationParam.setStatus(commandOptions.interpretationStatus);  // Unsupported param. FIXME
            interpretationParam.setAttributes(new HashMap<>(commandOptions.interpretationAttributes));

            ClinicalAnalysisQualityControlUpdateParam qualityControlParam = new ClinicalAnalysisQualityControlUpdateParam();
            qualityControlParam.setSummary(commandOptions.qualityControlSummary == null ? null : ClinicalAnalysisQualityControl.QualityControlSummary.valueOf(commandOptions.qualityControlSummary));

            ClinicalConsentAnnotationParam consentParam = new ClinicalConsentAnnotationParam();
            //consentParam.setConsents(commandOptions.consentConsents);  // Unsupported param. FIXME

            PriorityParam priorityParam = new PriorityParam();
            priorityParam.setId(commandOptions.priorityId);

            StatusParam statusParam = new StatusParam();
            statusParam.setId(commandOptions.statusId);

            //Set main body params
            clinicalAnalysisCreateParams.setId(commandOptions.id);
            clinicalAnalysisCreateParams.setDescription(commandOptions.description);
            clinicalAnalysisCreateParams.setType(commandOptions.type == null ? null : ClinicalAnalysis.Type.valueOf(commandOptions.type));
            clinicalAnalysisCreateParams.setDisorder(disorderParam);
            //clinicalAnalysisCreateParams.setFiles(commandOptions.files); // Unsupported param. FIXME 
            clinicalAnalysisCreateParams.setProband(probandParam);
            clinicalAnalysisCreateParams.setFamily(familyParam);
            //clinicalAnalysisCreateParams.setPanels(commandOptions.panels); // Unsupported param. FIXME 
            clinicalAnalysisCreateParams.setAnalyst(analystParam);
            clinicalAnalysisCreateParams.setReport(reportParam);
            clinicalAnalysisCreateParams.setInterpretation(interpretationParam);
            clinicalAnalysisCreateParams.setQualityControl(qualityControlParam);
            clinicalAnalysisCreateParams.setConsent(consentParam);
            clinicalAnalysisCreateParams.setCreationDate(commandOptions.creationDate);
            clinicalAnalysisCreateParams.setModificationDate(commandOptions.modificationDate);
            clinicalAnalysisCreateParams.setDueDate(commandOptions.dueDate);
            //clinicalAnalysisCreateParams.setComments(commandOptions.comments); // Unsupported param. FIXME 
            clinicalAnalysisCreateParams.setPriority(priorityParam);
            //clinicalAnalysisCreateParams.setFlags(commandOptions.flags); // Unsupported param. FIXME 
            clinicalAnalysisCreateParams.setAttributes(new HashMap<>(commandOptions.attributes));
            clinicalAnalysisCreateParams.setStatus(statusParam);

            if (commandOptions.panelLock != null) {
                clinicalAnalysisCreateParams.setPanelLock(commandOptions.panelLock);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().create(clinicalAnalysisCreateParams, queryParams);
    }

    private RestResponse<ObjectMap> distinct() throws Exception {

        logger.debug("Executing distinct in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.DistinctCommandOptions commandOptions = analysisClinicalCommandOptions.distinctCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("id", commandOptions.id);
        queryParams.putIfNotEmpty("uuid", commandOptions.uuid);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("disorder", commandOptions.disorder);
        queryParams.putIfNotEmpty("files", commandOptions.files);
        queryParams.putIfNotEmpty("sample", commandOptions.sample);
        queryParams.putIfNotEmpty("individual", commandOptions.individual);
        queryParams.putIfNotEmpty("proband", commandOptions.proband);
        queryParams.putIfNotEmpty("probandSamples", commandOptions.probandSamples);
        queryParams.putIfNotEmpty("family", commandOptions.family);
        queryParams.putIfNotEmpty("familyMembers", commandOptions.familyMembers);
        queryParams.putIfNotEmpty("familyMemberSamples", commandOptions.familyMemberSamples);
        queryParams.putIfNotEmpty("panels", commandOptions.panels);
        queryParams.putIfNotNull("locked", commandOptions.locked);
        queryParams.putIfNotEmpty("analystId", commandOptions.analystId);
        queryParams.putIfNotEmpty("priority", commandOptions.priority);
        queryParams.putIfNotEmpty("flags", commandOptions.flags);
        queryParams.putIfNotEmpty("creationDate", commandOptions.creationDate);
        queryParams.putIfNotEmpty("modificationDate", commandOptions.modificationDate);
        queryParams.putIfNotEmpty("dueDate", commandOptions.dueDate);
        queryParams.putIfNotEmpty("qualityControlSummary", commandOptions.qualityControlSummary);
        queryParams.putIfNotEmpty("release", commandOptions.release);
        queryParams.putIfNotEmpty("status", commandOptions.status);
        queryParams.putIfNotEmpty("internalStatus", commandOptions.internalStatus);
        queryParams.putIfNotNull("deleted", commandOptions.deleted);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().distinct(commandOptions.field, queryParams);
    }

    private RestResponse<ObjectMap> distinctInterpretation() throws Exception {

        logger.debug("Executing distinctInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.DistinctInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.distinctInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("id", commandOptions.id);
        queryParams.putIfNotEmpty("uuid", commandOptions.uuid);
        queryParams.putIfNotEmpty("clinicalAnalysisId", commandOptions.clinicalAnalysisId);
        queryParams.putIfNotEmpty("analystId", commandOptions.analystId);
        queryParams.putIfNotEmpty("methodName", commandOptions.methodName);
        queryParams.putIfNotEmpty("panels", commandOptions.panels);
        queryParams.putIfNotEmpty("primaryFindings", commandOptions.primaryFindings);
        queryParams.putIfNotEmpty("secondaryFindings", commandOptions.secondaryFindings);
        queryParams.putIfNotEmpty("creationDate", commandOptions.creationDate);
        queryParams.putIfNotEmpty("modificationDate", commandOptions.modificationDate);
        queryParams.putIfNotEmpty("status", commandOptions.status);
        queryParams.putIfNotEmpty("internalStatus", commandOptions.internalStatus);
        queryParams.putIfNotEmpty("release", commandOptions.release);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().distinctInterpretation(commandOptions.field, queryParams);
    }

    private RestResponse<Interpretation> searchInterpretation() throws Exception {

        logger.debug("Executing searchInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.SearchInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.searchInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("sort", commandOptions.sort);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("id", commandOptions.id);
        queryParams.putIfNotEmpty("uuid", commandOptions.uuid);
        queryParams.putIfNotEmpty("clinicalAnalysisId", commandOptions.clinicalAnalysisId);
        queryParams.putIfNotEmpty("analystId", commandOptions.analystId);
        queryParams.putIfNotEmpty("methodName", commandOptions.methodName);
        queryParams.putIfNotEmpty("panels", commandOptions.panels);
        queryParams.putIfNotEmpty("primaryFindings", commandOptions.primaryFindings);
        queryParams.putIfNotEmpty("secondaryFindings", commandOptions.secondaryFindings);
        queryParams.putIfNotEmpty("creationDate", commandOptions.creationDate);
        queryParams.putIfNotEmpty("modificationDate", commandOptions.modificationDate);
        queryParams.putIfNotEmpty("status", commandOptions.status);
        queryParams.putIfNotEmpty("internalStatus", commandOptions.internalStatus);
        queryParams.putIfNotEmpty("release", commandOptions.release);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().searchInterpretation(queryParams);
    }

    private RestResponse<Interpretation> infoInterpretation() throws Exception {

        logger.debug("Executing infoInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.InfoInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.infoInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("version", commandOptions.version);
        queryParams.putIfNotNull("deleted", commandOptions.deleted);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().infoInterpretation(commandOptions.interpretations, queryParams);
    }

    private RestResponse<Job> runInterpreterCancerTiering() throws Exception {

        logger.debug("Executing runInterpreterCancerTiering in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RunInterpreterCancerTieringCommandOptions commandOptions = analysisClinicalCommandOptions.runInterpreterCancerTieringCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("jobId", commandOptions.jobId);
        queryParams.putIfNotEmpty("executionDescription", commandOptions.executionDescription);
        queryParams.putIfNotEmpty("executionDependsOn", commandOptions.executionDependsOn);
        queryParams.putIfNotEmpty("executionTags", commandOptions.executionTags);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        CancerTieringInterpretationAnalysisParams cancerTieringInterpretationAnalysisParams = new CancerTieringInterpretationAnalysisParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Job> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(cancerTieringInterpretationAnalysisParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            cancerTieringInterpretationAnalysisParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), CancerTieringInterpretationAnalysisParams.class);
        } else {
            cancerTieringInterpretationAnalysisParams.setClinicalAnalysis(commandOptions.clinicalAnalysis);
            cancerTieringInterpretationAnalysisParams.setDiscardedVariants(splitWithTrim(commandOptions.discardedVariants));

            if (commandOptions.primary != null) {
                cancerTieringInterpretationAnalysisParams.setPrimary(commandOptions.primary);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().runInterpreterCancerTiering(cancerTieringInterpretationAnalysisParams, queryParams);
    }

    private RestResponse<Job> runInterpreterTeam() throws Exception {

        logger.debug("Executing runInterpreterTeam in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RunInterpreterTeamCommandOptions commandOptions = analysisClinicalCommandOptions.runInterpreterTeamCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("jobId", commandOptions.jobId);
        queryParams.putIfNotEmpty("executionDescription", commandOptions.executionDescription);
        queryParams.putIfNotEmpty("executionDependsOn", commandOptions.executionDependsOn);
        queryParams.putIfNotEmpty("executionTags", commandOptions.executionTags);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        TeamInterpretationAnalysisParams teamInterpretationAnalysisParams = new TeamInterpretationAnalysisParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Job> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(teamInterpretationAnalysisParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            teamInterpretationAnalysisParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), TeamInterpretationAnalysisParams.class);
        } else {
            teamInterpretationAnalysisParams.setClinicalAnalysis(commandOptions.clinicalAnalysis);
            teamInterpretationAnalysisParams.setPanels(splitWithTrim(commandOptions.panels));
            teamInterpretationAnalysisParams.setFamilySegregation(commandOptions.familySegregation);

            if (commandOptions.primary != null) {
                teamInterpretationAnalysisParams.setPrimary(commandOptions.primary);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().runInterpreterTeam(teamInterpretationAnalysisParams, queryParams);
    }

    private RestResponse<Job> runInterpreterTiering() throws Exception {

        logger.debug("Executing runInterpreterTiering in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RunInterpreterTieringCommandOptions commandOptions = analysisClinicalCommandOptions.runInterpreterTieringCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("jobId", commandOptions.jobId);
        queryParams.putIfNotEmpty("executionDescription", commandOptions.executionDescription);
        queryParams.putIfNotEmpty("executionDependsOn", commandOptions.executionDependsOn);
        queryParams.putIfNotEmpty("executionTags", commandOptions.executionTags);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        TieringInterpretationAnalysisParams tieringInterpretationAnalysisParams = new TieringInterpretationAnalysisParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Job> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(tieringInterpretationAnalysisParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            tieringInterpretationAnalysisParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), TieringInterpretationAnalysisParams.class);
        } else {
            tieringInterpretationAnalysisParams.setClinicalAnalysis(commandOptions.clinicalAnalysis);
            tieringInterpretationAnalysisParams.setPanels(splitWithTrim(commandOptions.panels));
            tieringInterpretationAnalysisParams.setPenetrance(commandOptions.penetrance == null ? null : ClinicalProperty.Penetrance.valueOf(commandOptions.penetrance));

            if (commandOptions.primary != null) {
                tieringInterpretationAnalysisParams.setPrimary(commandOptions.primary);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().runInterpreterTiering(tieringInterpretationAnalysisParams, queryParams);
    }

    private RestResponse<Job> runInterpreterZetta() throws Exception {

        logger.debug("Executing runInterpreterZetta in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RunInterpreterZettaCommandOptions commandOptions = analysisClinicalCommandOptions.runInterpreterZettaCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("jobId", commandOptions.jobId);
        queryParams.putIfNotEmpty("executionDescription", commandOptions.executionDescription);
        queryParams.putIfNotEmpty("executionDependsOn", commandOptions.executionDependsOn);
        queryParams.putIfNotEmpty("executionTags", commandOptions.executionTags);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        ZettaInterpretationAnalysisParams zettaInterpretationAnalysisParams = new ZettaInterpretationAnalysisParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Job> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(zettaInterpretationAnalysisParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            zettaInterpretationAnalysisParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), ZettaInterpretationAnalysisParams.class);
        } else {
            zettaInterpretationAnalysisParams.setClinicalAnalysis(commandOptions.bodyClinicalAnalysis);
            zettaInterpretationAnalysisParams.setId(splitWithTrim(commandOptions.bodyId));
            zettaInterpretationAnalysisParams.setRegion(commandOptions.bodyRegion);
            zettaInterpretationAnalysisParams.setType(commandOptions.bodyType);
            zettaInterpretationAnalysisParams.setStudy(commandOptions.bodyStudy);
            zettaInterpretationAnalysisParams.setFile(commandOptions.bodyFile);
            zettaInterpretationAnalysisParams.setFilter(commandOptions.bodyFilter);
            zettaInterpretationAnalysisParams.setQual(commandOptions.bodyQual);
            zettaInterpretationAnalysisParams.setFileData(commandOptions.bodyFileData);
            zettaInterpretationAnalysisParams.setSample(commandOptions.bodySample);
            zettaInterpretationAnalysisParams.setSampleData(commandOptions.bodySampleData);
            zettaInterpretationAnalysisParams.setSampleAnnotation(commandOptions.bodySampleAnnotation);
            zettaInterpretationAnalysisParams.setSampleMetadata(commandOptions.bodySampleMetadata);
            zettaInterpretationAnalysisParams.setCohort(commandOptions.bodyCohort);
            zettaInterpretationAnalysisParams.setCohortStatsRef(commandOptions.bodyCohortStatsRef);
            zettaInterpretationAnalysisParams.setCohortStatsAlt(commandOptions.bodyCohortStatsAlt);
            zettaInterpretationAnalysisParams.setCohortStatsMaf(commandOptions.bodyCohortStatsMaf);
            zettaInterpretationAnalysisParams.setCohortStatsMgf(commandOptions.bodyCohortStatsMgf);
            zettaInterpretationAnalysisParams.setCohortStatsPass(commandOptions.bodyCohortStatsPass);
            zettaInterpretationAnalysisParams.setScore(commandOptions.bodyScore);
            zettaInterpretationAnalysisParams.setFamily(commandOptions.bodyFamily);
            zettaInterpretationAnalysisParams.setFamilyDisorder(commandOptions.bodyFamilyDisorder);
            zettaInterpretationAnalysisParams.setFamilySegregation(commandOptions.bodyFamilySegregation);
            zettaInterpretationAnalysisParams.setFamilyMembers(commandOptions.bodyFamilyMembers);
            zettaInterpretationAnalysisParams.setFamilyProband(commandOptions.bodyFamilyProband);
            zettaInterpretationAnalysisParams.setGene(commandOptions.bodyGene);
            zettaInterpretationAnalysisParams.setCt(commandOptions.bodyCt);
            zettaInterpretationAnalysisParams.setXref(commandOptions.bodyXref);
            zettaInterpretationAnalysisParams.setBiotype(commandOptions.bodyBiotype);
            zettaInterpretationAnalysisParams.setProteinSubstitution(commandOptions.bodyProteinSubstitution);
            zettaInterpretationAnalysisParams.setConservation(commandOptions.bodyConservation);
            zettaInterpretationAnalysisParams.setPopulationFrequencyAlt(commandOptions.bodyPopulationFrequencyAlt);
            zettaInterpretationAnalysisParams.setPopulationFrequencyRef(commandOptions.bodyPopulationFrequencyRef);
            zettaInterpretationAnalysisParams.setPopulationFrequencyMaf(commandOptions.bodyPopulationFrequencyMaf);
            zettaInterpretationAnalysisParams.setTranscriptFlag(commandOptions.bodyTranscriptFlag);
            zettaInterpretationAnalysisParams.setGeneTraitId(commandOptions.bodyGeneTraitId);
            zettaInterpretationAnalysisParams.setGo(commandOptions.bodyGo);
            zettaInterpretationAnalysisParams.setExpression(commandOptions.bodyExpression);
            zettaInterpretationAnalysisParams.setProteinKeyword(commandOptions.bodyProteinKeyword);
            zettaInterpretationAnalysisParams.setDrug(commandOptions.bodyDrug);
            zettaInterpretationAnalysisParams.setFunctionalScore(commandOptions.bodyFunctionalScore);
            zettaInterpretationAnalysisParams.setClinical(commandOptions.bodyClinical);
            zettaInterpretationAnalysisParams.setClinicalSignificance(commandOptions.bodyClinicalSignificance);
            zettaInterpretationAnalysisParams.setCustomAnnotation(commandOptions.bodyCustomAnnotation);
            zettaInterpretationAnalysisParams.setPanel(commandOptions.bodyPanel);
            zettaInterpretationAnalysisParams.setPanelModeOfInheritance(commandOptions.bodyPanelModeOfInheritance);
            zettaInterpretationAnalysisParams.setPanelConfidence(commandOptions.bodyPanelConfidence);
            zettaInterpretationAnalysisParams.setPanelRoleInCancer(commandOptions.bodyPanelRoleInCancer);
            zettaInterpretationAnalysisParams.setTrait(commandOptions.bodyTrait);

            if (commandOptions.bodyClinicalConfirmedStatus != null) {
                zettaInterpretationAnalysisParams.setClinicalConfirmedStatus(commandOptions.bodyClinicalConfirmedStatus);
            }
            if (commandOptions.bodyPrimary != null) {
                zettaInterpretationAnalysisParams.setPrimary(commandOptions.bodyPrimary);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().runInterpreterZetta(zettaInterpretationAnalysisParams, queryParams);
    }

    private RestResponse<FacetField> aggregationStatsRga() throws Exception {

        logger.debug("Executing aggregationStatsRga in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.AggregationStatsRgaCommandOptions commandOptions = analysisClinicalCommandOptions.aggregationStatsRgaCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().aggregationStatsRga(commandOptions.field, queryParams);
    }

    private RestResponse<RgaKnockoutByGene> queryRgaGene() throws Exception {

        logger.debug("Executing queryRgaGene in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.QueryRgaGeneCommandOptions commandOptions = analysisClinicalCommandOptions.queryRgaGeneCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("includeIndividual", commandOptions.includeIndividual);
        queryParams.putIfNotNull("skipIndividual", commandOptions.skipIndividual);
        queryParams.putIfNotNull("limitIndividual", commandOptions.limitIndividual);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().queryRgaGene(queryParams);
    }

    private RestResponse<KnockoutByGeneSummary> summaryRgaGene() throws Exception {

        logger.debug("Executing summaryRgaGene in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.SummaryRgaGeneCommandOptions commandOptions = analysisClinicalCommandOptions.summaryRgaGeneCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().summaryRgaGene(queryParams);
    }

    private RestResponse<Job> runRgaIndex() throws Exception {

        logger.debug("Executing runRgaIndex in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RunRgaIndexCommandOptions commandOptions = analysisClinicalCommandOptions.runRgaIndexCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("jobId", commandOptions.jobId);
        queryParams.putIfNotEmpty("executionDescription", commandOptions.executionDescription);
        queryParams.putIfNotEmpty("executionDependsOn", commandOptions.executionDependsOn);
        queryParams.putIfNotEmpty("executionTags", commandOptions.executionTags);
        queryParams.putIfNotNull("auxiliarIndex", commandOptions.auxiliarIndex);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        RgaAnalysisParams rgaAnalysisParams = new RgaAnalysisParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Job> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(rgaAnalysisParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            rgaAnalysisParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), RgaAnalysisParams.class);
        } else {
            rgaAnalysisParams.setFile(commandOptions.file);

        }
        return openCGAClient.getClinicalAnalysisClient().runRgaIndex(rgaAnalysisParams, queryParams);
    }

    private RestResponse<KnockoutByIndividual> queryRgaIndividual() throws Exception {

        logger.debug("Executing queryRgaIndividual in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.QueryRgaIndividualCommandOptions commandOptions = analysisClinicalCommandOptions.queryRgaIndividualCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().queryRgaIndividual(queryParams);
    }

    private RestResponse<KnockoutByIndividualSummary> summaryRgaIndividual() throws Exception {

        logger.debug("Executing summaryRgaIndividual in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.SummaryRgaIndividualCommandOptions commandOptions = analysisClinicalCommandOptions.summaryRgaIndividualCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().summaryRgaIndividual(queryParams);
    }

    private RestResponse<KnockoutByVariant> queryRgaVariant() throws Exception {

        logger.debug("Executing queryRgaVariant in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.QueryRgaVariantCommandOptions commandOptions = analysisClinicalCommandOptions.queryRgaVariantCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("includeIndividual", commandOptions.includeIndividual);
        queryParams.putIfNotNull("skipIndividual", commandOptions.skipIndividual);
        queryParams.putIfNotNull("limitIndividual", commandOptions.limitIndividual);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().queryRgaVariant(queryParams);
    }

    private RestResponse<KnockoutByVariantSummary> summaryRgaVariant() throws Exception {

        logger.debug("Executing summaryRgaVariant in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.SummaryRgaVariantCommandOptions commandOptions = analysisClinicalCommandOptions.summaryRgaVariantCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("sampleId", commandOptions.sampleId);
        queryParams.putIfNotEmpty("individualId", commandOptions.individualId);
        queryParams.putIfNotEmpty("sex", commandOptions.sex);
        queryParams.putIfNotEmpty("phenotypes", commandOptions.phenotypes);
        queryParams.putIfNotEmpty("disorders", commandOptions.disorders);
        queryParams.putIfNotEmpty("numParents", commandOptions.numParents);
        queryParams.putIfNotEmpty("geneId", commandOptions.geneId);
        queryParams.putIfNotEmpty("geneName", commandOptions.geneName);
        queryParams.putIfNotEmpty("chromosome", commandOptions.chromosome);
        queryParams.putIfNotEmpty("start", commandOptions.start);
        queryParams.putIfNotEmpty("end", commandOptions.end);
        queryParams.putIfNotEmpty("transcriptId", commandOptions.transcriptId);
        queryParams.putIfNotEmpty("variants", commandOptions.variants);
        queryParams.putIfNotEmpty("dbSnps", commandOptions.dbSnps);
        queryParams.putIfNotEmpty("knockoutType", commandOptions.knockoutType);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotEmpty("populationFrequency", commandOptions.populationFrequency);
        queryParams.putIfNotEmpty("consequenceType", commandOptions.consequenceType);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().summaryRgaVariant(queryParams);
    }

    private RestResponse<ClinicalAnalysis> search() throws Exception {

        logger.debug("Executing search in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.SearchCommandOptions commandOptions = analysisClinicalCommandOptions.searchCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("id", commandOptions.id);
        queryParams.putIfNotEmpty("uuid", commandOptions.uuid);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("disorder", commandOptions.disorder);
        queryParams.putIfNotEmpty("files", commandOptions.files);
        queryParams.putIfNotEmpty("sample", commandOptions.sample);
        queryParams.putIfNotEmpty("individual", commandOptions.individual);
        queryParams.putIfNotEmpty("proband", commandOptions.proband);
        queryParams.putIfNotEmpty("probandSamples", commandOptions.probandSamples);
        queryParams.putIfNotEmpty("family", commandOptions.family);
        queryParams.putIfNotEmpty("familyMembers", commandOptions.familyMembers);
        queryParams.putIfNotEmpty("familyMemberSamples", commandOptions.familyMemberSamples);
        queryParams.putIfNotEmpty("panels", commandOptions.panels);
        queryParams.putIfNotNull("locked", commandOptions.locked);
        queryParams.putIfNotEmpty("analystId", commandOptions.analystId);
        queryParams.putIfNotEmpty("priority", commandOptions.priority);
        queryParams.putIfNotEmpty("flags", commandOptions.flags);
        queryParams.putIfNotEmpty("creationDate", commandOptions.creationDate);
        queryParams.putIfNotEmpty("modificationDate", commandOptions.modificationDate);
        queryParams.putIfNotEmpty("dueDate", commandOptions.dueDate);
        queryParams.putIfNotEmpty("qualityControlSummary", commandOptions.qualityControlSummary);
        queryParams.putIfNotEmpty("release", commandOptions.release);
        queryParams.putIfNotEmpty("status", commandOptions.status);
        queryParams.putIfNotEmpty("internalStatus", commandOptions.internalStatus);
        queryParams.putIfNotNull("deleted", commandOptions.deleted);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().search(queryParams);
    }

    private RestResponse<ClinicalVariant> actionableVariant() throws Exception {

        logger.debug("Executing actionableVariant in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.ActionableVariantCommandOptions commandOptions = analysisClinicalCommandOptions.actionableVariantCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("sample", commandOptions.sample);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().actionableVariant(queryParams);
    }

    private RestResponse<ClinicalVariant> queryVariant() throws Exception {

        logger.debug("Executing queryVariant in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.QueryVariantCommandOptions commandOptions = analysisClinicalCommandOptions.queryVariantCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotNull("limit", commandOptions.limit);
        queryParams.putIfNotNull("skip", commandOptions.skip);
        queryParams.putIfNotNull("count", commandOptions.count);
        queryParams.putIfNotNull("approximateCount", commandOptions.approximateCount);
        queryParams.putIfNotNull("approximateCountSamplingSize", commandOptions.approximateCountSamplingSize);
        queryParams.putIfNotEmpty("savedFilter", commandOptions.savedFilter);
        queryParams.putIfNotEmpty("id", commandOptions.id);
        queryParams.putIfNotEmpty("region", commandOptions.region);
        queryParams.putIfNotEmpty("type", commandOptions.type);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("file", commandOptions.file);
        queryParams.putIfNotEmpty("filter", commandOptions.filter);
        queryParams.putIfNotEmpty("qual", commandOptions.qual);
        queryParams.putIfNotEmpty("fileData", commandOptions.fileData);
        queryParams.putIfNotEmpty("sample", commandOptions.sample);
        queryParams.putIfNotEmpty("sampleData", commandOptions.sampleData);
        queryParams.putIfNotEmpty("sampleAnnotation", commandOptions.sampleAnnotation);
        queryParams.putIfNotEmpty("cohort", commandOptions.cohort);
        queryParams.putIfNotEmpty("cohortStatsRef", commandOptions.cohortStatsRef);
        queryParams.putIfNotEmpty("cohortStatsAlt", commandOptions.cohortStatsAlt);
        queryParams.putIfNotEmpty("cohortStatsMaf", commandOptions.cohortStatsMaf);
        queryParams.putIfNotEmpty("cohortStatsMgf", commandOptions.cohortStatsMgf);
        queryParams.putIfNotEmpty("cohortStatsPass", commandOptions.cohortStatsPass);
        queryParams.putIfNotEmpty("missingAlleles", commandOptions.missingAlleles);
        queryParams.putIfNotEmpty("missingGenotypes", commandOptions.missingGenotypes);
        queryParams.putIfNotEmpty("score", commandOptions.score);
        queryParams.putIfNotEmpty("family", commandOptions.family);
        queryParams.putIfNotEmpty("familyDisorder", commandOptions.familyDisorder);
        queryParams.putIfNotEmpty("familySegregation", commandOptions.familySegregation);
        queryParams.putIfNotEmpty("familyMembers", commandOptions.familyMembers);
        queryParams.putIfNotEmpty("familyProband", commandOptions.familyProband);
        queryParams.putIfNotEmpty("gene", commandOptions.gene);
        queryParams.putIfNotEmpty("ct", commandOptions.ct);
        queryParams.putIfNotEmpty("xref", commandOptions.xref);
        queryParams.putIfNotEmpty("biotype", commandOptions.biotype);
        queryParams.putIfNotEmpty("proteinSubstitution", commandOptions.proteinSubstitution);
        queryParams.putIfNotEmpty("conservation", commandOptions.conservation);
        queryParams.putIfNotEmpty("populationFrequencyAlt", commandOptions.populationFrequencyAlt);
        queryParams.putIfNotEmpty("populationFrequencyRef", commandOptions.populationFrequencyRef);
        queryParams.putIfNotEmpty("populationFrequencyMaf", commandOptions.populationFrequencyMaf);
        queryParams.putIfNotEmpty("transcriptFlag", commandOptions.transcriptFlag);
        queryParams.putIfNotEmpty("geneTraitId", commandOptions.geneTraitId);
        queryParams.putIfNotEmpty("go", commandOptions.go);
        queryParams.putIfNotEmpty("expression", commandOptions.expression);
        queryParams.putIfNotEmpty("proteinKeyword", commandOptions.proteinKeyword);
        queryParams.putIfNotEmpty("drug", commandOptions.drug);
        queryParams.putIfNotEmpty("functionalScore", commandOptions.functionalScore);
        queryParams.putIfNotEmpty("clinical", commandOptions.clinical);
        queryParams.putIfNotEmpty("clinicalSignificance", commandOptions.clinicalSignificance);
        queryParams.putIfNotNull("clinicalConfirmedStatus", commandOptions.clinicalConfirmedStatus);
        queryParams.putIfNotEmpty("customAnnotation", commandOptions.customAnnotation);
        queryParams.putIfNotEmpty("panel", commandOptions.panel);
        queryParams.putIfNotEmpty("panelModeOfInheritance", commandOptions.panelModeOfInheritance);
        queryParams.putIfNotEmpty("panelConfidence", commandOptions.panelConfidence);
        queryParams.putIfNotEmpty("panelRoleInCancer", commandOptions.panelRoleInCancer);
        queryParams.putIfNotEmpty("panelFeatureType", commandOptions.panelFeatureType);
        queryParams.putIfNotNull("panelIntersection", commandOptions.panelIntersection);
        queryParams.putIfNotEmpty("trait", commandOptions.trait);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().queryVariant(queryParams);
    }

    private RestResponse<ObjectMap> acl() throws Exception {

        logger.debug("Executing acl in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.AclCommandOptions commandOptions = analysisClinicalCommandOptions.aclCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("member", commandOptions.member);
        queryParams.putIfNotNull("silent", commandOptions.silent);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().acl(commandOptions.clinicalAnalyses, queryParams);
    }

    private RestResponse<ClinicalAnalysis> delete() throws Exception {

        logger.debug("Executing delete in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.DeleteCommandOptions commandOptions = analysisClinicalCommandOptions.deleteCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("force", commandOptions.force);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().delete(commandOptions.clinicalAnalyses, queryParams);
    }

    private RestResponse<ClinicalAnalysis> update() throws Exception {

        logger.debug("Executing update in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.UpdateCommandOptions commandOptions = analysisClinicalCommandOptions.updateCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("includeResult", commandOptions.includeResult);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        ClinicalAnalysisUpdateParams clinicalAnalysisUpdateParams = new ClinicalAnalysisUpdateParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<ClinicalAnalysis> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(clinicalAnalysisUpdateParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            clinicalAnalysisUpdateParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), ClinicalAnalysisUpdateParams.class);
        } else {
            // Generate beans for nested objects
            DisorderReferenceParam disorderParam = new DisorderReferenceParam();
            disorderParam.setId(commandOptions.disorderId);

            ProbandParam probandParam = new ProbandParam();
            probandParam.setId(commandOptions.probandId);
            //probandParam.setSamples(commandOptions.probandSamples);  // Unsupported param. FIXME

            FamilyParam familyParam = new FamilyParam();
            familyParam.setId(commandOptions.familyId);
            //familyParam.setMembers(commandOptions.familyMembers);  // Unsupported param. FIXME

            ClinicalAnalystParam analystParam = new ClinicalAnalystParam();
            analystParam.setId(commandOptions.analystId);

            ClinicalReport reportParam = new ClinicalReport();
            reportParam.setTitle(commandOptions.reportTitle);
            reportParam.setOverview(commandOptions.reportOverview);
            reportParam.setDiscussion(commandOptions.reportDiscussion);
            reportParam.setLogo(commandOptions.reportLogo);
            reportParam.setSignedBy(commandOptions.reportSignedBy);
            reportParam.setSignature(commandOptions.reportSignature);
            reportParam.setDate(commandOptions.reportDate);

            ClinicalAnalysisQualityControlUpdateParam qualityControlParam = new ClinicalAnalysisQualityControlUpdateParam();
            qualityControlParam.setSummary(commandOptions.qualityControlSummary == null ? null : ClinicalAnalysisQualityControl.QualityControlSummary.valueOf(commandOptions.qualityControlSummary));

            ClinicalConsentAnnotationParam consentParam = new ClinicalConsentAnnotationParam();
            //consentParam.setConsents(commandOptions.consentConsents);  // Unsupported param. FIXME

            PriorityParam priorityParam = new PriorityParam();
            priorityParam.setId(commandOptions.priorityId);

            StatusParam statusParam = new StatusParam();
            statusParam.setId(commandOptions.statusId);

            //Set main body params
            clinicalAnalysisUpdateParams.setId(commandOptions.id);
            clinicalAnalysisUpdateParams.setDescription(commandOptions.description);
            clinicalAnalysisUpdateParams.setType(commandOptions.type == null ? null : ClinicalAnalysis.Type.valueOf(commandOptions.type));
            clinicalAnalysisUpdateParams.setDisorder(disorderParam);
            //clinicalAnalysisUpdateParams.setFiles(commandOptions.files); // Unsupported param. FIXME 
            //clinicalAnalysisUpdateParams.setPanels(commandOptions.panels); // Unsupported param. FIXME 
            clinicalAnalysisUpdateParams.setProband(probandParam);
            clinicalAnalysisUpdateParams.setFamily(familyParam);
            clinicalAnalysisUpdateParams.setAnalyst(analystParam);
            clinicalAnalysisUpdateParams.setReport(reportParam);
            clinicalAnalysisUpdateParams.setQualityControl(qualityControlParam);
            clinicalAnalysisUpdateParams.setConsent(consentParam);
            clinicalAnalysisUpdateParams.setCreationDate(commandOptions.creationDate);
            clinicalAnalysisUpdateParams.setModificationDate(commandOptions.modificationDate);
            clinicalAnalysisUpdateParams.setDueDate(commandOptions.dueDate);
            //clinicalAnalysisUpdateParams.setComments(commandOptions.comments); // Unsupported param. FIXME 
            clinicalAnalysisUpdateParams.setPriority(priorityParam);
            //clinicalAnalysisUpdateParams.setFlags(commandOptions.flags); // Unsupported param. FIXME 
            clinicalAnalysisUpdateParams.setAttributes(new HashMap<>(commandOptions.attributes));
            clinicalAnalysisUpdateParams.setStatus(statusParam);

            if (commandOptions.panelLock != null) {
                clinicalAnalysisUpdateParams.setPanelLock(commandOptions.panelLock);
            }
            if (commandOptions.locked != null) {
                clinicalAnalysisUpdateParams.setLocked(commandOptions.locked);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().update(commandOptions.clinicalAnalyses, clinicalAnalysisUpdateParams, queryParams);
    }

    private RestResponse<ClinicalAnalysis> info() throws Exception {

        logger.debug("Executing info in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.InfoCommandOptions commandOptions = analysisClinicalCommandOptions.infoCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("deleted", commandOptions.deleted);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().info(commandOptions.clinicalAnalysis, queryParams);
    }

    private RestResponse<Interpretation> createInterpretation() throws Exception {

        logger.debug("Executing createInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.CreateInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.createInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("setAs", commandOptions.setAs);
        queryParams.putIfNotNull("includeResult", commandOptions.includeResult);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        InterpretationCreateParams interpretationCreateParams = new InterpretationCreateParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Interpretation> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(interpretationCreateParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            interpretationCreateParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), InterpretationCreateParams.class);
        } else {
            // Generate beans for nested objects
            ClinicalAnalystParam analystParam = new ClinicalAnalystParam();
            analystParam.setId(commandOptions.analystId);

            InterpretationMethod methodParam = new InterpretationMethod();
            methodParam.setName(commandOptions.methodName);
            methodParam.setVersion(commandOptions.methodVersion);
            methodParam.setCommit(commandOptions.methodCommit);
            //methodParam.setDependencies(commandOptions.methodDependencies);  // Unsupported param. FIXME

            StatusParam statusParam = new StatusParam();
            statusParam.setId(commandOptions.statusId);

            //Set main body params
            interpretationCreateParams.setDescription(commandOptions.description);
            interpretationCreateParams.setClinicalAnalysisId(commandOptions.clinicalAnalysisId);
            interpretationCreateParams.setCreationDate(commandOptions.creationDate);
            interpretationCreateParams.setModificationDate(commandOptions.modificationDate);
            interpretationCreateParams.setAnalyst(analystParam);
            interpretationCreateParams.setMethod(methodParam);
            //interpretationCreateParams.setPrimaryFindings(commandOptions.primaryFindings); // Unsupported param. FIXME 
            //interpretationCreateParams.setSecondaryFindings(commandOptions.secondaryFindings); // Unsupported param. FIXME 
            //interpretationCreateParams.setPanels(commandOptions.panels); // Unsupported param. FIXME 
            //interpretationCreateParams.setComments(commandOptions.comments); // Unsupported param. FIXME 
            interpretationCreateParams.setStatus(statusParam);
            interpretationCreateParams.setAttributes(new HashMap<>(commandOptions.attributes));

            if (commandOptions.locked != null) {
                interpretationCreateParams.setLocked(commandOptions.locked);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().createInterpretation(commandOptions.clinicalAnalysis, interpretationCreateParams, queryParams);
    }

    private RestResponse<Interpretation> clearInterpretation() throws Exception {

        logger.debug("Executing clearInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.ClearInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.clearInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().clearInterpretation(commandOptions.clinicalAnalysis, commandOptions.interpretations, queryParams);
    }

    private RestResponse<Interpretation> deleteInterpretation() throws Exception {

        logger.debug("Executing deleteInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.DeleteInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.deleteInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotEmpty("setAsPrimary", commandOptions.setAsPrimary);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().deleteInterpretation(commandOptions.clinicalAnalysis, commandOptions.interpretations, queryParams);
    }

    private RestResponse<Interpretation> revertInterpretation() throws Exception {

        logger.debug("Executing revertInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.RevertInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.revertInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("study", commandOptions.study);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }

        return openCGAClient.getClinicalAnalysisClient().revertInterpretation(commandOptions.clinicalAnalysis, commandOptions.interpretation, commandOptions.version, queryParams);
    }

    private RestResponse<Interpretation> updateInterpretation() throws Exception {

        logger.debug("Executing updateInterpretation in Analysis - Clinical command line");

        AnalysisClinicalCommandOptions.UpdateInterpretationCommandOptions commandOptions = analysisClinicalCommandOptions.updateInterpretationCommandOptions;

        ObjectMap queryParams = new ObjectMap();
        queryParams.putIfNotEmpty("include", commandOptions.include);
        queryParams.putIfNotEmpty("exclude", commandOptions.exclude);
        queryParams.putIfNotEmpty("study", commandOptions.study);
        queryParams.putIfNotNull("setAs", commandOptions.setAs);
        queryParams.putIfNotNull("includeResult", commandOptions.includeResult);
        if (queryParams.get("study") == null && OpencgaMain.isShellMode()) {
            queryParams.putIfNotEmpty("study", sessionManager.getSession().getCurrentStudy());
        }


        InterpretationUpdateParams interpretationUpdateParams = new InterpretationUpdateParams();
        if (commandOptions.jsonDataModel) {
            RestResponse<Interpretation> res = new RestResponse<>();
            res.setType(QueryType.VOID);
            PrintUtils.println(getObjectAsJSON(interpretationUpdateParams));
            return res;
        } else if (commandOptions.jsonFile != null) {
            interpretationUpdateParams = JacksonUtils.getDefaultObjectMapper()
                    .readValue(new java.io.File(commandOptions.jsonFile), InterpretationUpdateParams.class);
        } else {
            // Generate beans for nested objects
            ClinicalAnalystParam analystParam = new ClinicalAnalystParam();
            analystParam.setId(commandOptions.analystId);

            InterpretationMethod methodParam = new InterpretationMethod();
            methodParam.setName(commandOptions.methodName);
            methodParam.setVersion(commandOptions.methodVersion);
            methodParam.setCommit(commandOptions.methodCommit);
            //methodParam.setDependencies(commandOptions.methodDependencies);  // Unsupported param. FIXME

            StatusParam statusParam = new StatusParam();
            statusParam.setId(commandOptions.statusId);

            //Set main body params
            interpretationUpdateParams.setDescription(commandOptions.description);
            interpretationUpdateParams.setAnalyst(analystParam);
            interpretationUpdateParams.setMethod(methodParam);
            interpretationUpdateParams.setCreationDate(commandOptions.creationDate);
            interpretationUpdateParams.setModificationDate(commandOptions.modificationDate);
            //interpretationUpdateParams.setPrimaryFindings(commandOptions.primaryFindings); // Unsupported param. FIXME 
            //interpretationUpdateParams.setSecondaryFindings(commandOptions.secondaryFindings); // Unsupported param. FIXME 
            //interpretationUpdateParams.setPanels(commandOptions.panels); // Unsupported param. FIXME 
            //interpretationUpdateParams.setComments(commandOptions.comments); // Unsupported param. FIXME 
            interpretationUpdateParams.setStatus(statusParam);
            interpretationUpdateParams.setAttributes(new HashMap<>(commandOptions.attributes));

            if (commandOptions.locked != null) {
                interpretationUpdateParams.setLocked(commandOptions.locked);
            }
        }
        return openCGAClient.getClinicalAnalysisClient().updateInterpretation(commandOptions.clinicalAnalysis, commandOptions.interpretation, interpretationUpdateParams, queryParams);
    }
}